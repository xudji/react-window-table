import*as e from"react";import n,{useLayoutEffect as t,useEffect as r,useContext as o,useMemo as u,useRef as c,useCallback as i,useState as l,createContext as a,forwardRef as f,cloneElement as s}from"react";import{getOverflowAncestors as d,useFloating as v}from"@floating-ui/react-dom";export*from"@floating-ui/react-dom";import m from"point-in-polygon";import{createPortal as g}from"react-dom";import{hideOthers as p}from"aria-hidden";var h="undefined"!=typeof document?t:r;function b(){const e=new Map;return{emit(n,t){var r;null==(r=e.get(n))||r.forEach((e=>e(t)))},on(n,t){e.set(n,[...e.get(n)||[],t])},off(n,t){e.set(n,(e.get(n)||[]).filter((e=>e!==t)))}}}let y=!1,E=0;const w=()=>"floating-ui-"+E++;const x=e["useId".toString()],L=null!=x?x:function(){const[n,t]=e.useState((()=>y?w():void 0));return h((()=>{null==n&&t(w())}),[]),e.useEffect((()=>{y||(y=!0)}),[]),n},T=a(null),I=a(null),A=()=>{var e,n;return null!=(e=null==(n=o(T))?void 0:n.id)?e:null},k=()=>o(I),O=()=>{const e=L(),n=k(),t=A();return h((()=>{const r={id:e,parentId:t};return null==n||n.addNode(r),()=>{null==n||n.removeNode(r)}}),[n,e,t]),e},C=e=>{let{children:t,id:r}=e;const o=A();return n.createElement(T.Provider,{value:u((()=>({id:r,parentId:o})),[r,o])},t)},R=e=>{let{children:t}=e;const r=c([]),o=i((e=>{r.current=[...r.current,e]}),[]),a=i((e=>{r.current=r.current.filter((n=>n!==e))}),[]),f=l((()=>b()))[0];return n.createElement(I.Provider,{value:u((()=>({nodesRef:r,addNode:o,removeNode:a,events:f})),[r,o,a,f])},t)};function D(e,n,t){const r={};return{..."floating"===t&&{tabIndex:-1},...e,...n.map((e=>e?e[t]:null)).concat(e).reduce(((e,n)=>n?(Object.entries(n).forEach((n=>{let[t,o]=n;0===t.indexOf("on")?(r[t]||(r[t]=[]),"function"==typeof o&&r[t].push(o),e[t]=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];r[t].forEach((e=>e(...n)))}):e[t]=o})),e):e),{})}}const P=function(e){return void 0===e&&(e=[]),{getReferenceProps:n=>D(n,e,"reference"),getFloatingProps:n=>D(n,e,"floating"),getItemProps:n=>D(n,e,"item")}};function M(e){var n;return null!=(n=null==e?void 0:e.ownerDocument)?n:document}function S(e){var n;return null!=(n=M(e).defaultView)?n:window}function F(e){return!!e&&e instanceof S(e).Element}function j(e){return!!e&&e instanceof S(e).HTMLElement}function N(e,n){var t;let r=null!=(t=null==e?void 0:e.nodesRef.current.filter((e=>{var t;return e.parentId===n&&(null==(t=e.context)?void 0:t.open)})))?t:[],o=r;for(;o.length;){var u;o=null!=(u=null==e?void 0:e.nodesRef.current.filter((e=>{var n;return null==(n=o)?void 0:n.some((n=>{var t;return e.parentId===n.id&&(null==(t=e.context)?void 0:t.open)}))})))?u:[],r=r.concat(o)}return r}function B(e){let n,{restMs:t=0,buffer:r=1,debug:o=null}=void 0===e?{}:e;return e=>{let{x:o,y:u,placement:c,refs:i,onClose:l,nodeId:a,tree:f}=e;return function(e){var s;if(clearTimeout(n),e.pointerType&&"mouse"!==e.pointerType)return;const{target:d,clientX:v,clientY:g}=e,p=d;if("pointermove"===e.type&&F(i.reference.current)&&i.reference.current.contains(p)||null!=(s=i.floating.current)&&s.contains(p))return;if(f&&N(f,a).some((e=>{let{context:n}=e;return null==n?void 0:n.open})))return;if(!i.reference.current||!i.floating.current||null==c||null==o||null==u)return;const h=i.reference.current.getBoundingClientRect(),b=i.floating.current.getBoundingClientRect(),y=c.split("-")[0],E=o>b.right-b.width/2,w=u>b.bottom-b.height/2;switch(y){case"top":if(v>=b.left&&v<=b.right&&g>=b.bottom&&g<=h.top)return;break;case"bottom":if(v>=b.left&&v<=b.right&&g>=h.bottom&&g<=b.top)return;break;case"left":if(v>=b.right&&v<=h.left&&g>=b.left&&g<=b.right)return;break;case"right":if(v>=b.right&&v<=h.left&&g>=b.right&&g<=h.left)return}const x=function(e){let[n,t]=e;const o=b.width>h.width,u=b.height>h.height;switch(y){case"top":{const e=[o?n:E?n+r:n-r,t+r],u=[o?n:E?n-r:n+r,t+r],c=[[b.left,E||o?b.bottom-r:b.top],[b.right,E?o?b.bottom-r:b.top:b.bottom-r]];return E?[e,u,...c]:[e,...c,u]}case"bottom":{const e=[o?n:E?n+r:n-r,t-r],u=[o?n:E?n-r:n+r,t-r],c=[[b.left,E||o?b.top+r:b.bottom],[b.right,E?o?b.top+r:b.bottom:b.top+r]];return E?[e,u,...c]:[e,...c,u]}case"left":{const e=[n+r,u?t:w?t-r:t+r],o=[n+r,u?t:w?t+r:t-r],c=[[w||u?b.right-r:b.left,b.top],[w?u?b.right-r:b.left:b.right-r,b.bottom]];return w?[e,...c,o]:[...c,e,o]}case"right":{const e=[n-r,u?t:w?t+r:t-r],o=[n-r,u?t:w?t-r:t+r],c=[[w||u?b.left+r:b.right,b.top],[w?u?b.left+r:b.right:b.left+r,b.bottom]];return w?[e,o,...c]:[e,...c,o]}}}([o,u]);m([v,g],x)?t&&(n=setTimeout(l,t)):(clearTimeout(n),l())}}}const K="floating-ui-root",q=e=>{let{children:n,id:t=K}=e;const[r,o]=l(!1),u=c(null);return h((()=>{const e=document.getElementById(t);e?u.current=e:(u.current=document.createElement("div"),u.current.id=t);const n=u.current;document.body.contains(n)||document.body.appendChild(n),o(!0)}),[t]),r&&u.current?g(n,u.current):null};function H(){return H=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},H.apply(this,arguments)}const U="data-floating-ui-scroll-lock",V=f((function(e,t){let{lockScroll:r=!1,...o}=e;return h((()=>{if(!r)return;const e=window.pageXOffset,n=window.pageYOffset,t=Math.round(document.documentElement.getBoundingClientRect().left)+document.documentElement.scrollLeft?"paddingLeft":"paddingRight",o=window.innerWidth-document.documentElement.clientWidth;return document.body.hasAttribute(U)?void 0:(Object.assign(document.body.style,{position:"fixed",overflow:"hidden",top:"-"+n+"px",left:"-"+e+"px",right:"0",[t]:o+"px"}),document.body.setAttribute(U,""),()=>{Object.assign(document.body.style,{position:"",overflow:"",top:"",left:"",right:"",[t]:""}),document.body.removeAttribute(U),window.scrollTo(e,n)})}),[r]),n.createElement("div",H({ref:t},o,{style:{position:"fixed",overflow:"auto",top:0,right:0,bottom:0,left:0,...o.style}}))}));function X(e){e.preventDefault(),e.stopPropagation()}function Y(e){const n=c(e);return h((()=>{n.current=e})),n}function W(e){requestAnimationFrame((()=>{null==e||e.focus()}))}const z=f((function(e,t){return n.createElement("span",H({},e,{ref:t,tabIndex:0,style:{position:"fixed",opacity:"0",pointerEvents:"none",outline:"0"}}))}));function G(e){let{context:{refs:t,nodeId:o,onOpenChange:u},children:c,order:l=["content"],endGuard:a=!0,preventTabbing:f=!1,initialFocus:d=0,returnFocus:v=!0,modal:m=!0}=e;const g=Y(l),h=Y(u),b=k(),y=i((()=>g.current.map((e=>{return j(t.reference.current)&&"reference"===e?t.reference.current:t.floating.current&&"floating"===e?t.floating.current:"content"===e?Array.from(null!=(n=null==(r=t.floating.current)?void 0:r.querySelectorAll("input:not([type='hidden']):not([disabled]),select:not([disabled]),textarea:not([disabled]),a[href],button:not([disabled]),[tabindex],iframe,object,embed,area[href],audio[controls],video[controls],[contenteditable]:not([contenteditable='false'])"))?n:[]):null;var n,r})).flat().filter((e=>{if(e===t.floating.current||e===t.reference.current)return!0;if(j(e)){var n;return"-"!==(null!=(n=e.getAttribute("tabindex"))?n:"0")[0].trim()}}))),[g,t.floating,t.reference]);return r((()=>{const e=0===y().filter((e=>e!==t.floating.current&&e!==t.reference.current)).length;function n(n){if("Tab"===n.key){(f||e)&&X(n);const r=y();"reference"===g.current[0]&&n.target===t.reference.current&&(X(n),n.shiftKey?W(r[r.length-1]):W(r[1])),"floating"===g.current[1]&&n.target===t.floating.current&&n.shiftKey&&(X(n),W(r[0]))}}const r=M(t.floating.current);return r.addEventListener("keydown",n),()=>{r.removeEventListener("keydown",n)}}),[f,y,g,t.floating,t.reference]),r((()=>{function e(e){var n;const r=e.relatedTarget;null!=(n=t.floating.current)&&n.contains(r)||!F(t.reference.current)||t.reference.current.contains(r)||b&&N(b,o).some((e=>{var n,t;return null==(n=e.context)||null==(t=n.refs.floating.current)?void 0:t.contains(r)}))||h.current(!1)}const n=t.floating.current,r=t.reference.current;if(n&&j(r)){!m&&n.addEventListener("focusout",e);const t=m?p(n):null;return()=>{!m&&n.removeEventListener("focusout",e),null==t||t()}}}),[o,b,m,h,y,d,t.floating,t.reference]),r((()=>{var e;if(f)return;const n=t.floating.current,r=null!=(e=M(n).activeElement)?e:document.activeElement;var o;if("number"==typeof d)W(null!=(o=y()[d])?o:n);else if(j(null==d?void 0:d.current)){var u;W(null!=(u=d.current)?u:n)}return()=>{v&&j(r)&&W(r)}}),[f,y,d,m,v,t.floating]),n.createElement(n.Fragment,null,m&&n.createElement(z,{onFocus:e=>{X(e);const n=y();"reference"===l[0]?W(n[0]):W(n[n.length-1])}}),s(c,l.includes("floating")?{tabIndex:0}:{}),m&&a&&n.createElement(z,{onFocus:e=>{X(e),W(y()[0])}}))}function J(e,n,t){return t&&"mouse"!==t?0:"number"==typeof e?e:null==e?void 0:e[n]}const Q=function(e,n){let{enabled:t=!0,delay:o=0,handleClose:u=null,mouseOnly:l=!1,restMs:a=0}=void 0===n?{}:n;const{open:f,onOpenChange:s,dataRef:d,events:v,refs:m}=e,g=k(),p=Y(s),b=Y(u),y=c(),E=c(),w=c(),x=c(),L=c(!0);h((()=>{t&&(f||(y.current=void 0))})),r((()=>{if(t)return v.on("dismiss",e),()=>{v.off("dismiss",e)};function e(){clearTimeout(E.current),clearTimeout(x.current),L.current=!0}}),[t,v,m.floating]),r((()=>{if(!t||!b.current)return;function e(){var e;null!=(e=d.current.openEvent)&&e.type.includes("mouse")&&p.current(!1)}const n=M(m.floating.current).documentElement;return n.addEventListener("mouseleave",e),()=>{n.removeEventListener("mouseleave",e)}}),[m.floating,p,t,b,d]);const T=i((function(e){void 0===e&&(e=!0),o&&!w.current?(clearTimeout(E.current),E.current=setTimeout((()=>p.current(!1)),J(o,"close",y.current))):e&&p.current(!1)}),[o,p]),I=i((()=>{w.current&&(M(m.floating.current).removeEventListener("pointermove",w.current),w.current=void 0)}),[m.floating]);if(r((()=>{f||I()}),[f,t,I]),r((()=>{if(!t)return;function n(e){clearTimeout(E.current),L.current=!1,f||l&&"mouse"!==y.current||a>0&&0===J(o,"open")||(d.current.openEvent=e,o?E.current=setTimeout((()=>{p.current(!0)}),J(o,"open",y.current)):p.current(!0))}function r(n){var t,r;if("click"===(null==(t=d.current.openEvent)?void 0:t.type)||"pointerdown"===(null==(r=d.current.openEvent)?void 0:r.type))return;const o=M(m.floating.current);if(clearTimeout(x.current),b.current)return clearTimeout(E.current),w.current&&o.removeEventListener("pointermove",w.current),w.current=b.current({...e,tree:g,x:n.clientX,y:n.clientY,onClose(){I(),T()}}),void o.addEventListener("pointermove",w.current);T()}const u=m.reference.current;return F(u)?(u.addEventListener("mouseenter",n),u.addEventListener("mouseleave",r),()=>{u.removeEventListener("mouseenter",n),u.removeEventListener("mouseleave",r)}):void 0}),[t,T,e,o,b,d,l,p,f,g,a,I,m.reference,m.floating]),!t)return{};function A(e){y.current=e.pointerType}return{reference:{onPointerDown:A,onPointerEnter:A,onMouseMove(){f||0===a||(clearTimeout(x.current),x.current=setTimeout((()=>{L.current||s(!0)}),a))}},floating:{onMouseEnter(){clearTimeout(E.current)},onMouseLeave:()=>T(!1)}}},Z=a({delay:1e3,initialDelay:1e3,currentId:null,setCurrentId:()=>{},setState:()=>{}}),$=()=>o(Z),_=e=>{let{children:t,delay:r}=e;const[o,c]=l({delay:r,initialDelay:r,currentId:null}),a=i((e=>{c((n=>({...n,currentId:e})))}),[]);return n.createElement(Z.Provider,{value:u((()=>({...o,setState:c,setCurrentId:a})),[o,c,a])},t)},ee=(e,n)=>{let{open:t,onOpenChange:o}=e,{id:u}=n;const{currentId:c,initialDelay:i,setState:l}=$(),a=Y(o);r((()=>{c&&a.current&&(l((e=>({...e,delay:{open:1,close:J(i,"close")}}))),c!==u&&a.current(!1))}),[u,a,l,c,i]),r((()=>{!t&&c===u&&a.current&&(a.current(!1),l((e=>({...e,delay:i,currentId:null}))))}),[t,l,c,u,a,i])},ne=function(e,n){let{open:t}=e,{enabled:r=!0,role:o="dialog"}=void 0===n?{}:n;const u=L(),c=L(),i={id:u,role:o};return r?"tooltip"===o?{reference:{"aria-describedby":t?u:void 0},floating:i}:{reference:{"aria-expanded":t?"true":"false","aria-haspopup":o,"aria-controls":t?u:void 0,..."listbox"===o&&{role:"combobox"},..."menu"===o&&{id:c}},floating:{...i,..."menu"===o&&{"aria-labelledby":c}}}:{}},te=function(e,n){let{open:t,onOpenChange:r,dataRef:o}=e,{enabled:u=!0,pointerDown:i=!1,toggle:l=!0}=void 0===n?{}:n;const a=c();return u?{reference:{...i&&{onPointerDown(e){var n;(a.current=e.pointerType,t)?l&&"pointerdown"===(null==(n=o.current.openEvent)?void 0:n.type)&&r(!1):r(!0);o.current.openEvent=e.nativeEvent}},onClick(e){if(i&&a.current)a.current=void 0;else{var n;if(t)l&&"click"===(null==(n=o.current.openEvent)?void 0:n.type)&&r(!1);else r(!0);o.current.openEvent=e.nativeEvent}}}}:{}},re=function(e,n){let{open:t,onOpenChange:o,refs:u,events:c,nodeId:l}=e,{enabled:a=!0,escapeKey:f=!0,outsidePointerDown:s=!0,referencePointerDown:v=!1,ancestorScroll:m=!1,bubbles:g=!0}=void 0===n?{}:n;const p=k(),h=Y(o),b=i((()=>{var e;return null==(e=u.floating.current)?void 0:e.contains(M(u.floating.current).activeElement)}),[u.floating]),y=i((()=>{j(u.reference.current)&&u.reference.current.focus()}),[u.reference]);return r((()=>{if(!t||!a)return;function e(e){if("Escape"===e.key){if(!g&&!b())return;c.emit("dismiss"),h.current(!1),y()}}function n(e){var n;const t=p&&N(p,l).some((n=>{var t,r;return null==(t=n.context)||null==(r=t.refs.floating.current)?void 0:r.contains(e.target)}));null!=(n=u.floating.current)&&n.contains(e.target)||F(u.reference.current)&&u.reference.current.contains(e.target)||t||(g||b())&&(c.emit("dismiss"),h.current(!1),y())}function r(){h.current(!1)}const o=M(u.floating.current);f&&o.addEventListener("keydown",e),s&&o.addEventListener("mousedown",n);const i=(m?[...F(u.reference.current)?d(u.reference.current):[],...F(u.floating.current)?d(u.floating.current):[]]:[]).filter((e=>{var n;return e!==(null==(n=o.defaultView)?void 0:n.visualViewport)}));return i.forEach((e=>e.addEventListener("scroll",r,{passive:!0}))),()=>{f&&o.removeEventListener("keydown",e),s&&o.removeEventListener("mousedown",n),i.forEach((e=>e.removeEventListener("scroll",r)))}}),[f,s,c,p,l,t,h,y,m,a,g,b,u.floating,u.reference]),a?{reference:{onPointerDown(){v&&(c.emit("dismiss"),o(!1))}}}:{}},oe=function(e,n){let{open:t,onOpenChange:o,dataRef:u,refs:i,events:l}=e,{enabled:a=!0,keyboardOnly:f=!0}=void 0===n?{}:n;const s=c(!1);return r((()=>{var e;if(!a)return;const n=null!=(e=M(i.floating.current).defaultView)?e:window;function r(){s.current=!t}function o(){setTimeout((()=>{s.current=!1}))}return n.addEventListener("focus",o),n.addEventListener("blur",r),()=>{n.removeEventListener("focus",o),n.removeEventListener("blur",r)}}),[i.floating,t,a]),r((()=>{if(a)return l.on("dismiss",e),()=>{l.off("dismiss",e)};function e(){s.current=!0}}),[l,a]),a?{reference:{onPointerDown(e){let{pointerType:n}=e;s.current=!(!n||!f)},onFocus(e){var n,t,r;s.current||"focus"===e.type&&"mousedown"===(null==(n=u.current.openEvent)?void 0:n.type)&&F(i.reference.current)&&null!=(t=i.reference.current)&&t.contains(null==(r=u.current.openEvent)?void 0:r.target)||(u.current.openEvent=e.nativeEvent,o(!0))},onBlur(e){var n;const t=e.relatedTarget;null!=(n=i.floating.current)&&n.contains(t)||F(i.reference.current)&&i.reference.current.contains(t)||(s.current=!1,o(!1))}}}:{}},ue=["content"];function ce(e){requestAnimationFrame((()=>{null==e||e.focus()}))}const ie=function(e,n){let{open:t,onOpenChange:o,refs:u,nodeId:l}=e,{enabled:a=!0,initialContentFocus:f=0,order:s=ue,modal:d=!0,inert:v=!1}=void 0===n?{}:n;const m=c(!1),g=c(null),b=c(null),y=Y(d),E=Y(s),w=i((()=>E.current.map((e=>{return j(u.reference.current)&&"reference"===e?u.reference.current:u.floating.current&&"floating"===e?u.floating.current:"content"===e?Array.from(null!=(n=null==(t=u.floating.current)?void 0:t.querySelectorAll("a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,*[tabindex],*[contenteditable]"))?n:[]):null;var n,t})).filter(Boolean).flat()),[u.floating,u.reference]);h((()=>{const e=u.floating.current;if(!(a&&t&&e&&d))return;function n(){const n=M(e).createElement("div");return n.tabIndex=0,Object.assign(n.style,{position:"fixed",outline:"0",pointerEvents:"none"}),n.setAttribute("aria-hidden","true"),n}g.current||(g.current=n()),b.current||(b.current=n());const r=g.current,o=b.current;function c(e){var n;X(e);const t=w();null==(n=t[e.target===o?0:t.length-1])||n.focus()}return e.insertAdjacentElement("beforebegin",r),e.insertAdjacentElement("afterend",o),r.addEventListener("focus",c),o.addEventListener("focus",c),()=>{var e,n;r.removeEventListener("focus",c),o.removeEventListener("focus",c),null!=(e=r.parentNode)&&e.contains(r)&&r.parentNode.removeChild(r),null!=(n=o.parentNode)&&n.contains(o)&&o.parentNode.removeChild(o)}}),[a,t,d,v,w,u.floating]),r((()=>{if(!a||!t||!v)return;function e(e){"Tab"===e.key&&X(e)}const n=M(u.floating.current);return n.addEventListener("keydown",e),()=>{n.removeEventListener("keydown",e)}}),[a,t,v,u.floating]),r((()=>{if(!a)return;const e=w();if(v){if(t){const n=e[0];n!==u.floating.current||n.contains(n.ownerDocument.activeElement)||ce(n)}}else t&&("number"==typeof f?ce(e[f]):f.current&&ce(e.find((e=>e===f.current))))}),[w,t,v,d,f,a,u.reference,u.floating]),r((()=>{a&&!v&&!t&&y.current&&m.current&&j(u.reference.current)&&ce(u.reference.current)}),[t,a,v,y,u.reference]),r((()=>{if(t&&d&&a&&u.floating.current)return p(u.floating.current)}),[t,d,a,u.floating]),r((()=>(m.current=!0,()=>{m.current=!1})),[]);const x=k();function L(e){var n;const t=e.relatedTarget;null!=(n=u.floating.current)&&n.contains(t)||!F(u.reference.current)||u.reference.current.contains(t)||x&&N(x,l).some((e=>{var n,r,o;return null==(n=e.context)||null==(r=n.refs.floating)||null==(o=r.current)?void 0:o.contains(t)}))||o(!1)}return a?d?{floating:{"aria-modal":"true"}}:{reference:{onBlur:L},floating:{onBlur:L}}:{}};function le(e,n){let{startingIndex:t=-1,decrement:r=!1}=void 0===n?{}:n;const o=e.current;let u=t;do{var c,i;u+=r?-1:1}while(u>=0&&u<=o.length-1&&(null==o[u]||null!=(c=o[u])&&c.hasAttribute("disabled")||"true"===(null==(i=o[u])?void 0:i.getAttribute("aria-disabled"))));return u}function ae(e,n,t){switch(e){case"vertical":return n;case"horizontal":return t;default:return n||t}}function fe(e,n){return ae(n,"ArrowUp"===e||"ArrowDown"===e,"ArrowLeft"===e||"ArrowRight"===e)}function se(e,n,t){return ae(n,"ArrowDown"===e,t?"ArrowLeft"===e:"ArrowRight"===e)}function de(e){return le(e)}function ve(e){return le(e,{decrement:!0,startingIndex:e.current.length})}const me=function(e,n){let{open:t,onOpenChange:r,refs:o}=e,{listRef:u,activeIndex:a,onNavigate:f,enabled:s=!0,selectedIndex:d=null,allowEscape:v=!1,loop:m=!1,nested:g=!1,rtl:p=!1,virtual:b=!1,focusItemOnOpen:y="auto",focusItemOnHover:E=!0,orientation:w="vertical"}=void 0===n?{listRef:{current:[]},activeIndex:null,onNavigate:()=>{}}:n;const x=A(),L=k(),T=function(e){const n=c();return h((()=>{n.current=e}),[e]),n.current}(t),I=c(y),O=c(null!=d?d:-1),C=c(""),R=c(!1),D=Y(f),P=c(!1),[M,S]=l(),F=i(((e,n)=>{var t,r;b?S(null==(t=e.current[n.current])?void 0:t.id):null==(r=e.current[n.current])||r.focus({preventScroll:!0})}),[b]);function N(e){"auto"===y&&(I.current=!e.pointerType)}function B(e){if(P.current=!0,g&&function(e,n,t){return ae(n,t?"ArrowRight"===e:"ArrowLeft"===e,"ArrowUp"===e)}(e.key,w,p))return X(e),r(!1),void(j(o.reference.current)&&o.reference.current.focus());const n=O.current,t=de(u),c=ve(u);if("Home"===e.key&&(O.current=t,f(O.current)),"End"===e.key&&(O.current=c,f(O.current)),fe(e.key,w)){if(X(e),!b&&e.currentTarget.ownerDocument.activeElement===e.currentTarget)return O.current=null!=d?d:se(e.key,w,p)?t:c,void f(O.current);se(e.key,w,p)?O.current=m?n>=c?v&&n!==u.current.length?-1:t:le(u,{startingIndex:n}):Math.min(c,le(u,{startingIndex:n})):O.current=m?n<=t?v&&-1!==n?u.current.length:c:le(u,{startingIndex:n,decrement:!0}):Math.max(t,le(u,{startingIndex:n,decrement:!0})),f(O.current)}}return h((()=>{s&&(null!=d&&(O.current=d),!T&&t&&I.current&&(D.current(O.current),F(u,O)))}),[t,T,d,u,D,F,s]),h((()=>{s&&t&&(null===a?(!T&&I.current&&null==d||v)&&(O.current=v?-1:de(u),D.current(a),F(u,O)):(O.current=a,D.current(a),F(u,O)))}),[t,T,a,d,g,u,D,F,s,x,v,o.floating,null==L?void 0:L.nodesRef]),h((()=>{if(null==d&&s){if(t&&(fe(C.current,w)||I.current&&(" "===C.current||"Enter"===C.current))){const e=de(u),n=ve(u);O.current=function(e,n,t){return ae(n,"ArrowUp"===e,t?"ArrowRight"===e:"ArrowLeft"===e)}(C.current,w,p)?v?u.current.length:n:v?-1:e,D.current(O.current),F(u,O)}C.current=""}}),[t,u,d,D,F,s,w,p,v]),h((()=>{s&&!t&&R.current&&null!=d&&j(o.reference.current)&&o.reference.current.focus()}),[o.reference,d,t,s]),h((()=>(R.current=!0,()=>{R.current=!1})),[]),h((()=>{var e;s&&(t||("auto"===y&&(I.current=!0),O.current=null!=(e=null!=d?d:a)?e:-1,D.current(null)))}),[t,d,a,s,y,D]),s?{reference:{...b&&t&&null!=a&&{"aria-activedescendant":M},onPointerEnter:N,onPointerDown:N,onKeyDown(e){if(P.current=!0,b&&t)return B(e);"auto"===y&&(I.current=!0),C.current=e.key,g?function(e,n,t){return ae(n,t?"ArrowLeft"===e:"ArrowRight"===e,"ArrowDown"===e)}(e.key,w,p)&&(X(e),t?(O.current=de(u),f(O.current)):r(!0)):(fe(e.key,w)&&(O.current=null==d?se(e.key,w,p)?de(u):ve(u):d,X(e),r(!0),f(O.current)),b&&!t&&B(e))}},floating:{"aria-orientation":"both"===w?void 0:w,...b&&null!=a&&{"aria-activedescendant":M},onKeyDown:B,onPointerMove(){P.current=!1}},item:{onClick:e=>{let{currentTarget:n}=e;return n.focus({preventScroll:!0})},...E&&{onPointerMove(e){let{currentTarget:n}=e;const t=n;if(t){const e=u.current.indexOf(t);-1!==e&&f(e)}},onPointerLeave(){var e;P.current||(f(null),b?(O.current=-1,F(u,O)):null==(e=o.floating.current)||e.focus({preventScroll:!0}))}}}}:{}},ge=function(e,n){var t;let{open:r,dataRef:o}=e,{listRef:u,activeIndex:i,onMatch:l=(()=>{}),enabled:a=!0,findMatch:f=null,resetMs:s=1e3,ignoreKeys:d=[],selectedIndex:v=null}=void 0===n?{listRef:{current:[]},activeIndex:null}:n;const m=c(),g=c(""),p=c(null!=(t=null!=v?v:i)?t:-1),b=c(null);function y(e){if(!e.currentTarget.contains(M(e.currentTarget).activeElement))return;g.current.length>0&&" "!==g.current[0]&&(o.current.typing=!0," "===e.key&&X(e));const n=u.current;if(null==n||["Home","End","Escape","Enter","Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight",...d].includes(e.key))return;n.every((e=>{var n,t;return!e||(null==(n=e[0])?void 0:n.toLocaleLowerCase())!==(null==(t=e[1])?void 0:t.toLocaleLowerCase())}))&&g.current===e.key&&(g.current="",p.current=b.current),g.current+=e.key,clearTimeout(m.current),m.current=setTimeout((()=>{g.current="",p.current=b.current,o.current.typing=!1}),s);const t=p.current,r=[...n.slice((null!=t?t:0)+1),...n.slice(0,(null!=t?t:0)+1)],c=f?f(r,g.current):r.find((e=>0===(null==e?void 0:e.toLocaleLowerCase().indexOf(g.current)))),i=c?n.indexOf(c):-1;-1!==i&&(l(i),b.current=i)}return h((()=>{r&&(clearTimeout(m.current),b.current=null,g.current="")}),[r]),h((()=>{var e;r&&""===g.current&&(p.current=null!=(e=null!=v?v:i)?e:-1)}),[r,v,i]),a?{reference:{onKeyDown:y},floating:{onKeyDown:y}}:{}};function pe(e){let{open:n=!1,onOpenChange:t=(()=>{}),placement:r,middleware:o,strategy:i,nodeId:a}=void 0===e?{}:e;const f=k(),s=c({}),d=l((()=>b()))[0],m=v({placement:r,middleware:o,strategy:i}),g=u((()=>({...m,dataRef:s,nodeId:a,events:d,open:n,onOpenChange:t})),[m,s,a,d,n,t]);return h((()=>{const e=null==f?void 0:f.nodesRef.current.find((e=>e.id===a));e&&(e.context=g)})),u((()=>({context:g,...m})),[m,g])}export{_ as FloatingDelayGroup,G as FloatingFocusManager,C as FloatingNode,V as FloatingOverlay,q as FloatingPortal,R as FloatingTree,B as safePolygon,te as useClick,ee as useDelayGroup,$ as useDelayGroupContext,re as useDismiss,pe as useFloating,O as useFloatingNodeId,A as useFloatingParentNodeId,k as useFloatingTree,oe as useFocus,ie as useFocusTrap,Q as useHover,L as useId,P as useInteractions,me as useListNavigation,ne as useRole,ge as useTypeahead};
